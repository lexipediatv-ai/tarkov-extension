<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ Teste v1.2 - Tarkov Stats</title>
    <link rel="stylesheet" href="styles/config.css">
    <style>
        body {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #3a3a3a;
        }
        .test-section h2 {
            color: #d4af37;
            margin-top: 0;
        }
        .test-case {
            background: #0f0f0f;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #6a9a66;
        }
        .test-case.fail {
            border-left-color: #d63031;
        }
        .test-result {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 5px;
            font-weight: bold;
            margin-left: 10px;
        }
        .test-result.pass {
            background: #6a9a66;
            color: white;
        }
        .test-result.fail {
            background: #d63031;
            color: white;
        }
        .test-result.pending {
            background: #f39c12;
            color: white;
        }
        .controls {
            margin: 20px 0;
        }
        button {
            padding: 12px 24px;
            margin: 5px;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            font-size: 14px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #d4af37 0%, #9a8866 100%);
            color: #0f0f0f;
        }
        .btn-secondary {
            background: #3a3a3a;
            color: #c7c5b3;
        }
        .console-output {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 10px;
        }
        .console-line {
            margin: 5px 0;
        }
        .console-line.error {
            color: #ff6b6b;
        }
        .console-line.success {
            color: #51cf66;
        }
        .console-line.info {
            color: #74c0fc;
        }
    </style>
</head>
<body>
    <h1 style="color: #d4af37; text-align: center;">üß™ Teste Automatizado v1.2</h1>
    
    <div class="test-section">
        <h2>üìã Checklist de Valida√ß√£o</h2>
        
        <div class="test-case" id="test-fields">
            <strong>‚úì Campos presentes:</strong>
            <span class="test-result pending">Testando...</span>
            <div class="console-output" id="output-fields"></div>
        </div>
        
        <div class="test-case" id="test-validation">
            <strong>‚úì Valida√ß√£o funcionando:</strong>
            <span class="test-result pending">Testando...</span>
            <div class="console-output" id="output-validation"></div>
        </div>
        
        <div class="test-case" id="test-functions">
            <strong>‚úì Fun√ß√µes definidas:</strong>
            <span class="test-result pending">Testando...</span>
            <div class="console-output" id="output-functions"></div>
        </div>
        
        <div class="test-case" id="test-events">
            <strong>‚úì Event listeners:</strong>
            <span class="test-result pending">Testando...</span>
            <div class="console-output" id="output-events"></div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>üéÆ Teste Manual</h2>
        <p style="color: #9a8866;">Use os controles abaixo para testar o comportamento da interface:</p>
        
        <div class="controls">
            <button class="btn-primary" onclick="testValidInput()">
                ‚úÖ Preencher Dados V√°lidos
            </button>
            <button class="btn-secondary" onclick="testInvalidNickname()">
                ‚ùå Nickname Inv√°lido
            </button>
            <button class="btn-secondary" onclick="testInvalidId()">
                ‚ùå ID Inv√°lido
            </button>
            <button class="btn-primary" onclick="clearInputs()">
                üîÑ Limpar Campos
            </button>
        </div>
        
        <iframe 
            src="config.html" 
            style="width: 100%; height: 600px; border: 2px solid #3a3a3a; border-radius: 10px; background: white;"
            id="config-iframe">
        </iframe>
    </div>
    
    <div class="test-section">
        <h2>üìä Console de Teste</h2>
        <div class="console-output" id="main-console">
            <div class="console-line info">[INFO] Sistema de teste carregado</div>
            <div class="console-line info">[INFO] Aguardando execu√ß√£o dos testes...</div>
        </div>
        <div class="controls">
            <button class="btn-primary" onclick="runAllTests()">‚ñ∂Ô∏è Executar Todos os Testes</button>
            <button class="btn-secondary" onclick="clearConsole()">üóëÔ∏è Limpar Console</button>
        </div>
    </div>

    <script>
        let testsPassed = 0;
        let testsFailed = 0;

        function log(message, type = 'info') {
            const console = document.getElementById('main-console');
            const line = document.createElement('div');
            line.className = `console-line ${type}`;
            const timestamp = new Date().toLocaleTimeString();
            line.textContent = `[${timestamp}] ${message}`;
            console.appendChild(line);
            console.scrollTop = console.scrollHeight;
        }

        function updateTestResult(testId, passed, details) {
            const testCase = document.getElementById(testId);
            const resultSpan = testCase.querySelector('.test-result');
            const output = document.getElementById(`output-${testId.replace('test-', '')}`);
            
            resultSpan.textContent = passed ? '‚úÖ PASS' : '‚ùå FAIL';
            resultSpan.className = `test-result ${passed ? 'pass' : 'fail'}`;
            testCase.className = `test-case ${passed ? '' : 'fail'}`;
            
            output.innerHTML = details.map(d => 
                `<div class="console-line ${d.type || 'info'}">${d.message}</div>`
            ).join('');

            if (passed) {
                testsPassed++;
                log(`‚úÖ ${testId} passou`, 'success');
            } else {
                testsFailed++;
                log(`‚ùå ${testId} falhou`, 'error');
            }
        }

        function testFields() {
            log('Testando campos da interface...', 'info');
            const iframe = document.getElementById('config-iframe');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            const details = [];
            let allPresent = true;

            const fields = [
                { id: 'player-nickname', name: 'Nickname' },
                { id: 'player-id-input', name: 'Player ID' },
                { id: 'fetch-button', name: 'Bot√£o Buscar' }
            ];

            fields.forEach(field => {
                const element = iframeDoc.getElementById(field.id);
                if (element) {
                    details.push({ 
                        message: `‚úì ${field.name} encontrado (id: ${field.id})`,
                        type: 'success'
                    });
                } else {
                    details.push({ 
                        message: `‚úó ${field.name} N√ÉO encontrado (id: ${field.id})`,
                        type: 'error'
                    });
                    allPresent = false;
                }
            });

            updateTestResult('test-fields', allPresent, details);
        }

        function testValidation() {
            log('Testando valida√ß√£o de campos...', 'info');
            const iframe = document.getElementById('config-iframe');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            const iframeWindow = iframe.contentWindow;
            
            const details = [];
            let validationWorks = true;

            try {
                // Verificar se fun√ß√£o existe
                if (typeof iframeWindow.checkFormInputs === 'function') {
                    details.push({ 
                        message: '‚úì Fun√ß√£o checkFormInputs() existe',
                        type: 'success'
                    });
                } else {
                    details.push({ 
                        message: '‚úó Fun√ß√£o checkFormInputs() N√ÉO encontrada',
                        type: 'error'
                    });
                    validationWorks = false;
                }

                // Testar bot√£o desabilitado inicialmente
                const button = iframeDoc.getElementById('fetch-button');
                if (button && button.disabled) {
                    details.push({ 
                        message: '‚úì Bot√£o come√ßa desabilitado',
                        type: 'success'
                    });
                } else {
                    details.push({ 
                        message: '‚úó Bot√£o deveria come√ßar desabilitado',
                        type: 'error'
                    });
                    validationWorks = false;
                }
            } catch (error) {
                details.push({ 
                    message: `‚úó Erro ao testar: ${error.message}`,
                    type: 'error'
                });
                validationWorks = false;
            }

            updateTestResult('test-validation', validationWorks, details);
        }

        function testFunctions() {
            log('Verificando fun√ß√µes JavaScript...', 'info');
            const iframe = document.getElementById('config-iframe');
            const iframeWindow = iframe.contentWindow;
            
            const details = [];
            let allFunctionsPresent = true;

            const functions = [
                'checkFormInputs',
                'fetchStats',
                'displayStats',
                'showManualStatsForm'
            ];

            functions.forEach(func => {
                if (typeof iframeWindow[func] === 'function') {
                    details.push({ 
                        message: `‚úì ${func}() definida`,
                        type: 'success'
                    });
                } else {
                    details.push({ 
                        message: `‚úó ${func}() N√ÉO definida`,
                        type: 'error'
                    });
                    allFunctionsPresent = false;
                }
            });

            updateTestResult('test-functions', allFunctionsPresent, details);
        }

        function testEvents() {
            log('Testando event listeners...', 'info');
            const details = [];
            
            // Este teste √© mais complexo e requer acesso aos listeners
            // Por ora, verificamos se os campos t√™m o atributo necess√°rio
            const iframe = document.getElementById('config-iframe');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            const nickname = iframeDoc.getElementById('player-nickname');
            const playerId = iframeDoc.getElementById('player-id-input');
            
            let eventsOk = true;
            
            if (nickname && playerId) {
                details.push({ 
                    message: '‚úì Campos de input presentes',
                    type: 'success'
                });
                details.push({ 
                    message: '‚Ñπ Event listeners devem ser testados manualmente',
                    type: 'info'
                });
            } else {
                details.push({ 
                    message: '‚úó Campos de input n√£o encontrados',
                    type: 'error'
                });
                eventsOk = false;
            }

            updateTestResult('test-events', eventsOk, details);
        }

        function runAllTests() {
            log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'info');
            log('Iniciando bateria de testes v1.2...', 'info');
            log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'info');
            
            testsPassed = 0;
            testsFailed = 0;

            setTimeout(() => {
                testFields();
                setTimeout(() => {
                    testValidation();
                    setTimeout(() => {
                        testFunctions();
                        setTimeout(() => {
                            testEvents();
                            setTimeout(() => {
                                log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'info');
                                log(`Testes conclu√≠dos: ${testsPassed} passou, ${testsFailed} falhou`, 
                                    testsFailed > 0 ? 'error' : 'success');
                                log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'info');
                            }, 500);
                        }, 500);
                    }, 500);
                }, 500);
            }, 1000);
        }

        function testValidInput() {
            log('Preenchendo com dados v√°lidos...', 'info');
            const iframe = document.getElementById('config-iframe');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            const nickname = iframeDoc.getElementById('player-nickname');
            const playerId = iframeDoc.getElementById('player-id-input');
            
            if (nickname && playerId) {
                nickname.value = 'regular';
                playerId.value = '10590762';
                
                // Trigger input events
                nickname.dispatchEvent(new Event('input', { bubbles: true }));
                playerId.dispatchEvent(new Event('input', { bubbles: true }));
                
                log('‚úÖ Campos preenchidos: nickname=regular, id=10590762', 'success');
            }
        }

        function testInvalidNickname() {
            log('Testando nickname inv√°lido...', 'info');
            const iframe = document.getElementById('config-iframe');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            const nickname = iframeDoc.getElementById('player-nickname');
            const playerId = iframeDoc.getElementById('player-id-input');
            
            if (nickname && playerId) {
                nickname.value = 'a'; // Menos de 2 caracteres
                playerId.value = '10590762';
                
                nickname.dispatchEvent(new Event('input', { bubbles: true }));
                playerId.dispatchEvent(new Event('input', { bubbles: true }));
                
                log('‚ö†Ô∏è Nickname inv√°lido (1 char) - Bot√£o deve estar desabilitado', 'info');
            }
        }

        function testInvalidId() {
            log('Testando ID inv√°lido...', 'info');
            const iframe = document.getElementById('config-iframe');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            const nickname = iframeDoc.getElementById('player-nickname');
            const playerId = iframeDoc.getElementById('player-id-input');
            
            if (nickname && playerId) {
                nickname.value = 'regular';
                playerId.value = '123'; // Menos de 4 caracteres
                
                nickname.dispatchEvent(new Event('input', { bubbles: true }));
                playerId.dispatchEvent(new Event('input', { bubbles: true }));
                
                log('‚ö†Ô∏è ID inv√°lido (3 chars) - Bot√£o deve estar desabilitado', 'info');
            }
        }

        function clearInputs() {
            log('Limpando campos...', 'info');
            const iframe = document.getElementById('config-iframe');
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            const nickname = iframeDoc.getElementById('player-nickname');
            const playerId = iframeDoc.getElementById('player-id-input');
            
            if (nickname && playerId) {
                nickname.value = '';
                playerId.value = '';
                
                nickname.dispatchEvent(new Event('input', { bubbles: true }));
                playerId.dispatchEvent(new Event('input', { bubbles: true }));
                
                log('üîÑ Campos limpos', 'info');
            }
        }

        function clearConsole() {
            const console = document.getElementById('main-console');
            console.innerHTML = '<div class="console-line info">[INFO] Console limpo</div>';
        }

        // Auto-executar testes ap√≥s carregar iframe
        window.addEventListener('load', () => {
            setTimeout(() => {
                log('P√°gina de teste carregada', 'success');
                log('Clique em "Executar Todos os Testes" para come√ßar', 'info');
            }, 1000);
        });
    </script>
</body>
</html>
