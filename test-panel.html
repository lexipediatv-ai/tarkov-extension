<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Panel Test</title>
</head>
<body>
    <h1>Panel Debug Test</h1>
    <div id="output" style="font-family: monospace; white-space: pre;"></div>
    
    <script>
        const output = document.getElementById('output');
        
        function log(msg) {
            output.textContent += msg + '\n';
            console.log(msg);
        }
        
        log('üöÄ Starting panel test...\n');
        
        // Check localStorage
        try {
            const raw = localStorage.getItem('tarkov_ext_config');
            log('üì¶ localStorage raw: ' + (raw ? 'EXISTS' : 'EMPTY'));
            
            if (raw) {
                log('üìÑ Content: ' + raw);
                
                const parsed = JSON.parse(raw);
                log('‚úÖ Parsed successfully');
                log('üìä Config: ' + JSON.stringify(parsed.config, null, 2));
                
                if (parsed.config && parsed.config.playerId) {
                    log('\nüéØ Found Player ID: ' + parsed.config.playerId);
                    log('‚è≥ Fetching stats...\n');
                    
                    // Test fetch
                    fetch('http://localhost:8080/api/player/id/' + parsed.config.playerId)
                        .then(r => r.json())
                        .then(data => {
                            log('‚úÖ Stats fetched successfully!');
                            log('üë§ Nickname: ' + data.nickname);
                            log('‚≠ê Level: ' + data.stats.level);
                            log('üèÜ Prestige: ' + data.stats.prestige);
                            log('üêª Faction: ' + data.stats.faction);
                            log('üéØ Raids: ' + data.stats.raids);
                            log('üíÄ K/D: ' + data.stats.kd);
                        })
                        .catch(err => {
                            log('‚ùå Fetch error: ' + err.message);
                        });
                } else {
                    log('‚ùå No playerId in config');
                }
            } else {
                log('‚ùå localStorage is empty!');
                log('\nüí° Steps:');
                log('1. Go to http://localhost:8081/config.html');
                log('2. Enter Player ID: 10590762');
                log('3. Click "Save Player ID"');
                log('4. Come back here and refresh');
            }
        } catch (e) {
            log('‚ùå Error: ' + e.message);
        }
    </script>
</body>
</html>
